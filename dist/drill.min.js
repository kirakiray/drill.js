//! drill.js - v5.2.2 https://github.com/kirakiray/drill.js  (c) 2018-2023 YAO
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).lm=t()}(this,(function(){"use strict";class e{constructor(){this._middlewares=new Map}use(e){const t=Math.random().toString(32).slice(2);return this._middlewares.set(t,e),t}unuse(e){return this._middlewares.delete(e)}async run(e){let t=-1;const s=Array.from(this._middlewares.values()),n=async()=>{t++,t<s.length&&await s[t](e,n)};await n()}}const t={},s=(s,n)=>{(t[s]||(t[s]=new e)).use(n)},n=(e,t)=>{e instanceof Function&&(t=e,e=["js","mjs"]),e instanceof Array?e.forEach((e=>{s(e,t)})):s(e,t)};n(["mjs","js"],(async(e,t)=>{if(!e.result){const{url:t,params:s}=e,n=new URL(t);/^blob:/.test(t)||/^data:/.test(t)||s.includes("-direct")?e.result=await import(t):e.result=await import(`${n.origin}${n.pathname}`)}await t()})),n(["txt","html","htm"],(async(e,t)=>{if(!e.result){const{url:t}=e;e.result=await fetch(t).then((e=>e.text()))}await t()})),n("json",(async(e,t)=>{if(!e.result){const{url:t}=e;e.result=await fetch(t).then((e=>e.json()))}await t()})),n("wasm",(async(e,t)=>{if(!e.result){const{url:t}=e,s=await fetch(t).then((e=>e.arrayBuffer())),n=await WebAssembly.compile(s),i=new WebAssembly.Instance(n);e.result=i.exports}await t()})),n("css",(async(e,t)=>{if(!e.result){const{url:t,element:s}=e;if(s){const e=document.createElement("link");e.rel="stylesheet",e.href=t;const n=s.getRootNode();let i;n===document?n.head.append(e):n.appendChild(e),s.addEventListener("disconnected",i=t=>{e.remove(),s.removeEventListener("disconnected",i)})}else e.result=await fetch(t).then((e=>e.text()))}await t()}));const i=Symbol("loaded"),r=async(e,s)=>{const n=new URL(e),{pathname:r}=n;let a;s.params&&s.params.forEach((e=>{/^\..+/.test(e)&&(a=e.replace(/^\.(.+)/,"$1"))})),a||(a=r.slice(2+(r.lastIndexOf(".")-1>>>0)));const o={url:e,result:null,...s},c=t[a];if(c?await c.run(o):o.result=fetch(e),s&&s.element){const{element:e}=s;e[i]=!0;const t=new Event("load");e.dispatchEvent(t)}return o.result};function a(e){return(e=>(e||(e={url:document.location.href}),t=>{let s="";const[n,...i]=t.split(" ");if(e.resolve)s=e.resolve(n);else{const t=new URL(e.url);s=new URL(n,t).href}return r(s,{params:i})}))(e)}Object.assign(a,{use:n});class o extends HTMLElement{constructor(...e){super(...e),this[i]=!1,Object.defineProperties(this,{loaded:{get:()=>this[i]}}),this._init()}_init(){if(this.__initSrc||this.attributes.hasOwnProperty("pause"))return;let e=this.getAttribute("src");if(!e)return;this.__initSrc=e,e=new URL(e,location.href).href,Object.defineProperties(this,{src:{configurable:!0,value:e}});const[t,...s]=e.split(" ");r(t,{element:this,params:s})}connectedCallback(){const e=new CustomEvent("connected");e.root=this._root=this.getRootNode(),this.dispatchEvent(e)}disconnectedCallback(){const e=new CustomEvent("disconnected");e.root=this._root,delete this._root,this.dispatchEvent(e)}attributeChangedCallback(e,t,s){"src"===e?s&&null===t?this._init():this.__initSrc&&t&&s!==this.__initSrc&&(console.warn(`${this.tagName.toLowerCase()} change src is invalid, only the first change will be loaded`),this.setAttribute("src",this.__initSrc)):"pause"===e&&null===s&&this._init()}static get observedAttributes(){return["src","pause"]}}class c extends o{constructor(...e){super(...e)}}const l=()=>{customElements.define("load-module",o),customElements.define("l-m",c),window.removeEventListener("load",l)};return"complete"===document.readyState?l():window.addEventListener("load",l),window.lm=a,a}));
//# sourceMappingURL=drill.min.js.map
