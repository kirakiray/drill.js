{"version":3,"file":"drill.min.js","sources":["../ofa-error/main.js","../src/onion.mjs","../src/use.mjs","../src/config.mjs","../src/main.mjs","../src/component.mjs","../src/base.mjs"],"sourcesContent":["// const error_origin = \"http://127.0.0.1:5793/errors\";\nconst error_origin = \"https://ofajs.github.io/ofa-errors/errors\";\n\n// 存放错误信息的数据对象\nconst errors = {};\n\nif (globalThis.navigator && navigator.language) {\n  let langFirst = navigator.language.toLowerCase().split(\"-\")[0];\n\n  if (langFirst === \"zh\" && navigator.language.toLowerCase() !== \"zh-cn\") {\n    langFirst = \"zhft\";\n  }\n\n  (async () => {\n    if (localStorage[\"ofa-errors\"]) {\n      const targetLangErrors = JSON.parse(localStorage[\"ofa-errors\"]);\n      Object.assign(errors, targetLangErrors);\n    }\n\n    const errCacheTime = localStorage[\"ofa-errors-time\"];\n\n    if (!errCacheTime || Date.now() > Number(errCacheTime) + 5 * 60 * 1000) {\n      const targetLangErrors = await fetch(`${error_origin}/${langFirst}.json`)\n        .then((e) => e.json())\n        .catch(() => null);\n\n      if (targetLangErrors) {\n        localStorage[\"ofa-errors\"] = JSON.stringify(targetLangErrors);\n        localStorage[\"ofa-errors-time\"] = Date.now();\n      } else {\n        targetLangErrors = await fetch(`${error_origin}/en.json`)\n          .then((e) => e.json())\n          .catch((error) => {\n            console.error(error);\n            return null;\n          });\n      }\n\n      Object.assign(errors, targetLangErrors);\n    }\n  })();\n}\n\nlet isSafari = false;\nif (globalThis.navigator) {\n  isSafari =\n    navigator.userAgent.includes(\"Safari\") &&\n    !navigator.userAgent.includes(\"Chrome\");\n}\n\n/**\n * 根据键、选项和错误对象生成错误对象。\n *\n * @param {string} key - 错误描述的键。\n * @param {Object} [options] - 映射相关值的选项对象。\n * @param {Error} [error] - 原始错误对象。\n * @returns {Error} 生成的错误对象。\n */\nexport const getErr = (key, options, error) => {\n  let desc = getErrDesc(key, options);\n\n  let errObj;\n  if (error) {\n    if (isSafari) {\n      desc += `\\nCaused by: ${error.toString()}\\n  ${error.stack.replace(\n        /\\n/g,\n        \"\\n    \"\n      )}`;\n    }\n    errObj = new Error(desc, { cause: error });\n  } else {\n    errObj = new Error(desc);\n  }\n  errObj.code = key;\n  return errObj;\n};\n\n/**\n * 根据键、选项生成错误描述\n *\n * @param {string} key - 错误描述的键。\n * @param {Object} [options] - 映射相关值的选项对象。\n * @returns {string} 生成的错误描述。\n */\nexport const getErrDesc = (key, options) => {\n  if (!errors[key]) {\n    return `Error code: \"${key}\", please go to https://github.com/ofajs/ofa-errors to view the corresponding error information`;\n  }\n\n  let desc = errors[key];\n\n  // 映射相关值\n  if (options) {\n    for (let k in options) {\n      desc = desc.replace(new RegExp(`{${k}}`, \"g\"), options[k]);\n    }\n  }\n\n  return desc;\n};\n","const getOid = () => Math.random().toString(32).slice(2);\n\nexport default class Onion {\n  constructor() {\n    this._middlewares = new Map();\n  }\n\n  use(middleware) {\n    const oid = getOid();\n    this._middlewares.set(oid, middleware);\n    return oid;\n  }\n\n  unuse(oid) {\n    return this._middlewares.delete(oid);\n  }\n\n  async run(context) {\n    let index = -1;\n\n    const middlewares = Array.from(this._middlewares.values());\n\n    const next = async () => {\n      index++;\n      if (index < middlewares.length) {\n        await middlewares[index](context, next);\n      }\n    };\n\n    await next();\n  }\n}\n","import { getErr } from \"../ofa-error/main.js\";\nimport Onion from \"./onion.mjs\";\n\nconst getNotHttp = (url) => /^blob:/.test(url) || /^data:/.test(url);\n\nexport const caches = new Map();\nexport const wrapFetch = async (url, params) => {\n  let reUrl = url;\n\n  if (!getNotHttp(url)) {\n    const d = new URL(url);\n    reUrl = params.includes(\"-direct\") ? url : `${d.origin}${d.pathname}`;\n  }\n\n  let fetchObj = caches.get(reUrl);\n\n  if (!fetchObj) {\n    fetchObj = fetch(reUrl);\n    caches.set(reUrl, fetchObj);\n  }\n\n  const resp = await fetchObj;\n\n  return resp.clone();\n};\n\nexport const processor = {};\n\nconst addHandler = (name, handler) => {\n  const oni = processor[name] || (processor[name] = new Onion());\n  oni.use(handler);\n};\n\nexport const use = (name, handler) => {\n  if (name instanceof Function) {\n    handler = name;\n    name = [\"js\", \"mjs\"];\n  }\n\n  if (name instanceof Array) {\n    name.forEach((name) => {\n      addHandler(name, handler);\n    });\n    return;\n  }\n\n  addHandler(name, handler);\n};\n\nuse([\"mjs\", \"js\"], async (ctx, next) => {\n  if (!ctx.result) {\n    const { url, params } = ctx;\n    const d = new URL(url);\n\n    const notHttp = getNotHttp(url);\n    try {\n      if (notHttp || params.includes(\"-direct\")) {\n        ctx.result = await import(url);\n      } else {\n        ctx.result = await import(`${d.origin}${d.pathname}`);\n      }\n    } catch (error) {\n      const err = getErr(\n        \"load_module\",\n        {\n          url: ctx.realUrl || url,\n        },\n        error\n      );\n\n      if (notHttp) {\n        console.warn(err, ctx);\n      }\n\n      throw err;\n    }\n  }\n\n  await next();\n});\n\nuse([\"txt\", \"html\", \"htm\"], async (ctx, next) => {\n  if (!ctx.result) {\n    const { url, params } = ctx;\n\n    let resp;\n    try {\n      resp = await wrapFetch(url, params);\n    } catch (error) {\n      throw getErr(\"load_fail\", { url }, error);\n    }\n\n    if (!/^2.{2}$/.test(resp.status)) {\n      throw getErr(\"load_fail_status\", {\n        url,\n        status: resp.status,\n      });\n    }\n\n    ctx.result = await resp.text();\n  }\n\n  await next();\n});\n\nuse(\"json\", async (ctx, next) => {\n  if (!ctx.result) {\n    const { url, params } = ctx;\n\n    ctx.result = await wrapFetch(url, params).then((e) => e.json());\n  }\n\n  await next();\n});\n\nuse(\"wasm\", async (ctx, next) => {\n  if (!ctx.result) {\n    const { url, params } = ctx;\n\n    const data = await wrapFetch(url, params).then((e) => e.arrayBuffer());\n\n    const module = await WebAssembly.compile(data);\n    const instance = new WebAssembly.Instance(module);\n\n    ctx.result = instance.exports;\n  }\n\n  await next();\n});\n\nuse(\"css\", async (ctx, next) => {\n  if (!ctx.result) {\n    const { url, element, params } = ctx;\n\n    if (element) {\n      const link = document.createElement(\"link\");\n      link.rel = \"stylesheet\";\n      link.href = url;\n\n      const root = element.getRootNode();\n\n      if (root === document) {\n        root.head.append(link);\n      } else {\n        root.appendChild(link);\n      }\n\n      let f;\n      element.addEventListener(\n        \"disconnected\",\n        (f = (e) => {\n          link.remove();\n          element.removeEventListener(\"disconnected\", f);\n        })\n      );\n    } else {\n      ctx.result = await wrapFetch(url, params).then((e) => e.text());\n    }\n  }\n\n  await next();\n});\n","import { getErr } from \"../ofa-error/main.js\";\n\nexport const aliasMap = {};\n\nexport default async function config(opts) {\n  const { alias } = opts;\n\n  if (alias) {\n    Object.entries(alias).forEach(([name, path]) => {\n      if (!/^@.+/.test(name)) {\n        throw getErr(\"config_alias_name_error\", {\n          name,\n        });\n      }\n\n      if (!aliasMap[name]) {\n        if (!/^\\./.test(path)) {\n          aliasMap[name] = path;\n        } else {\n          throw getErr(\"alias_relate_name\", {\n            name,\n            path,\n          });\n        }\n      } else {\n        throw getErr(\"alias_already\", {\n          name,\n        });\n      }\n    });\n  }\n  return true;\n}\n\nexport const path = (moduleName, baseURI) => {\n  if (moduleName.startsWith(\"http://\") || moduleName.startsWith(\"https://\")) {\n    return moduleName;\n  }\n\n  const [url, ...params] = moduleName.split(\" \");\n\n  let lastUrl = url;\n\n  if (/^@/.test(url)) {\n    const [first, ...args] = url.split(\"/\");\n\n    if (aliasMap[first]) {\n      lastUrl = [aliasMap[first].replace(/\\/$/, \"\"), ...args].join(\"/\");\n    } else {\n      throw getErr(\"no_alias\", {\n        name: first,\n        url: moduleName,\n      });\n    }\n  }\n\n  if (typeof location !== \"undefined\") {\n    const base = baseURI ? new URL(baseURI, location.href) : location.href;\n\n    const moduleURL = new URL(lastUrl, base);\n\n    lastUrl = moduleURL.href;\n  }\n\n  if (params.length) {\n    return `${lastUrl} ${params.join(\" \")}`;\n  }\n\n  return lastUrl;\n};\n","import { processor, use } from \"./use.mjs\";\nimport { aliasMap, path } from \"./config.mjs\";\nexport const LOADED = Symbol(\"loaded\");\n\nconst createLoad = (meta, opts) => {\n  if (!meta) {\n    meta = {\n      url: document.location.href,\n    };\n  }\n  const load = (ourl) => {\n    let [url, ...params] = ourl.split(\" \");\n\n    const reurl = path(url, meta.url);\n\n    return agent(reurl, { params, ...opts });\n  };\n  return load;\n};\n\nexport const agent = async (url, opts) => {\n  const urldata = new URL(url);\n  const { pathname } = urldata;\n\n  let type;\n  let realUrl = null;\n\n  opts.params &&\n    opts.params.forEach((e) => {\n      if (/^\\..+/.test(e)) {\n        type = e.replace(/^\\.(.+)/, \"$1\");\n      } else if (/^\\-\\-real/.test(e)) {\n        realUrl = e.replace(/^\\-\\-real\\:/, \"\");\n      }\n    });\n\n  if (!type) {\n    type = pathname.slice(((pathname.lastIndexOf(\".\") - 1) >>> 0) + 2);\n  }\n\n  const ctx = {\n    url,\n    result: null,\n    realUrl,\n    ...opts,\n  };\n\n  const oni = processor[type];\n\n  if (oni) {\n    await oni.run(ctx);\n  } else {\n    const result = await fetch(url);\n    const contentType = result.headers.get(\"Content-Type\");\n\n    const targetMapObject = [\n      [\"application/javascript\", \"js\"],\n      [\"application/json\", \"json\"],\n      [\"text/html\", \"html\"],\n      [\"text/xml\", \"xml\"],\n    ].find((e) => contentType.includes(e[0]));\n\n    let newOni;\n    if (targetMapObject) {\n      newOni = processor[targetMapObject[1]];\n    }\n\n    if (newOni) {\n      await newOni.run(ctx);\n    } else {\n      ctx.result = result;\n    }\n  }\n\n  if (opts && opts.element) {\n    const { element } = opts;\n    element[LOADED] = true;\n    const event = new Event(\"load\");\n    element.dispatchEvent(event);\n  }\n\n  if (opts.params && opts.params.includes(\"-ctx\")) {\n    return ctx;\n  }\n\n  return ctx.result;\n};\n\nexport default function lm(meta, opts) {\n  return createLoad(meta, opts);\n}\n\nObject.defineProperties(lm, {\n  use: {\n    value: use,\n  },\n  alias: {\n    get() {\n      return { ...aliasMap };\n    },\n  },\n});\n","import { getErr } from \"../ofa-error/main.js\";\nimport { agent, LOADED } from \"./main.mjs\";\n\nclass LoadModule extends HTMLElement {\n  constructor(...args) {\n    super(...args);\n\n    this[LOADED] = false;\n\n    Object.defineProperties(this, {\n      loaded: {\n        get: () => this[LOADED],\n      },\n    });\n\n    this._init();\n  }\n\n  _init() {\n    if (this.__initSrc || this.attributes.hasOwnProperty(\"pause\")) {\n      return;\n    }\n\n    let src = this.getAttribute(\"src\");\n\n    if (!src) {\n      return;\n      // throw `The ${this.tagName.toLowerCase()} element requires the src attribut `;\n    }\n    this.__initSrc = src;\n\n    const load = lm(undefined, {\n      element: this,\n    });\n\n    load(src);\n\n    Object.defineProperties(this, {\n      src: {\n        configurable: true,\n        value: src,\n      },\n    });\n  }\n\n  connectedCallback() {\n    const event = new CustomEvent(\"connected\");\n    event.root = this._root = this.getRootNode();\n    this.dispatchEvent(event);\n  }\n\n  disconnectedCallback() {\n    const event = new CustomEvent(\"disconnected\");\n    event.root = this._root;\n    delete this._root;\n    this.dispatchEvent(event);\n  }\n\n  attributeChangedCallback(name, oldValue, newValue) {\n    if (name === \"src\") {\n      if (newValue && oldValue === null) {\n        this._init();\n      } else if (this.__initSrc && oldValue && newValue !== this.__initSrc) {\n        this.setAttribute(\"src\", this.__initSrc);\n\n        throw getErr(\"change_lm_src\", {\n          tag: this.tagName.toLowerCase(),\n        });\n      }\n    } else if (name === \"pause\" && newValue === null) {\n      this._init();\n    }\n  }\n\n  static get observedAttributes() {\n    return [\"src\", \"pause\"];\n  }\n}\n\nclass LM extends LoadModule {\n  constructor(...args) {\n    super(...args);\n  }\n}\n\nconst ready = () => {\n  customElements.define(\"load-module\", LoadModule);\n  customElements.define(\"l-m\", LM);\n  window.removeEventListener(\"load\", ready);\n};\n\nif (document.readyState === \"complete\") {\n  ready();\n} else {\n  window.addEventListener(\"load\", ready);\n}\n","import lm from \"./main.mjs\";\nimport \"./component.mjs\";\nimport config, { path } from \"./config.mjs\";\nlm.config = config;\nlm.path = path;\nObject.freeze(lm);\n\nwindow.lm = lm;\n\nexport default lm;\n"],"names":["error_origin","errors","globalThis","navigator","language","langFirst","toLowerCase","split","localStorage","targetLangErrors","JSON","parse","Object","assign","errCacheTime","Date","now","Number","fetch","then","e","json","catch","stringify","error","console","isSafari","userAgent","includes","getErr","key","options","errObj","desc","getErrDesc","toString","stack","replace","Error","cause","code","k","RegExp","Onion","constructor","this","_middlewares","Map","use","middleware","oid","Math","random","slice","set","unuse","delete","async","context","index","middlewares","Array","from","values","next","length","getNotHttp","url","test","caches","wrapFetch","params","reUrl","d","URL","origin","pathname","fetchObj","get","clone","processor","addHandler","name","handler","Function","forEach","ctx","result","notHttp","import","err","realUrl","warn","resp","status","text","data","arrayBuffer","module","WebAssembly","compile","instance","Instance","exports","element","link","document","createElement","rel","href","root","getRootNode","f","head","append","appendChild","addEventListener","remove","removeEventListener","aliasMap","path","moduleName","baseURI","startsWith","lastUrl","first","args","join","location","base","LOADED","Symbol","agent","opts","urldata","type","lastIndexOf","oni","run","contentType","headers","targetMapObject","find","newOni","event","Event","dispatchEvent","lm","meta","ourl","reurl","createLoad","defineProperties","value","alias","LoadModule","HTMLElement","super","loaded","_init","__initSrc","attributes","hasOwnProperty","src","getAttribute","undefined","load","configurable","connectedCallback","CustomEvent","_root","disconnectedCallback","attributeChangedCallback","oldValue","newValue","setAttribute","tag","tagName","observedAttributes","LM","ready","customElements","define","window","readyState","lm$1","config","entries","freeze"],"mappings":"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"}