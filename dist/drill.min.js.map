{"version":3,"file":"drill.min.js","sources":["../ofa-error/main.js","../src/onion.mjs","../src/use.mjs","../src/config.mjs","../src/main.mjs","../src/component.mjs","../src/base.mjs"],"sourcesContent":["// const error_origin = \"http://127.0.0.1:5793/errors\";\nconst error_origin = \"https://ofajs.github.io/ofa-errors/errors\";\n\n// 存放错误信息的数据对象\nconst errors = {};\n\nif (globalThis.navigator && navigator.language) {\n  let langFirst = navigator.language.toLowerCase().split(\"-\")[0];\n\n  if (langFirst === \"zh\" && navigator.language.toLowerCase() !== \"zh-cn\") {\n    langFirst = \"zhft\";\n  }\n\n  fetch(`${error_origin}/${langFirst}.json`)\n    .catch(() => {\n      return fetch(`${error_origin}/default.json`);\n    })\n    .then((e) => e.json())\n    .catch((err) => {\n      console.error(err);\n      return {};\n    })\n    .then((data) => {\n      Object.assign(errors, data);\n    });\n}\n/**\n * 根据键、选项和错误对象生成错误对象。\n *\n * @param {string} key - 错误描述的键。\n * @param {Object} [options] - 映射相关值的选项对象。\n * @param {Error} [error] - 原始错误对象。\n * @returns {Error} 生成的错误对象。\n */\nexport const getErr = (key, options, error) => {\n  const desc = getErrDesc(key, options);\n\n  let errObj;\n  if (error) {\n    errObj = new Error(desc, { cause: error });\n  } else {\n    errObj = new Error(desc);\n  }\n  return errObj;\n};\n\n/**\n * 根据键、选项生成错误描述\n *\n * @param {string} key - 错误描述的键。\n * @param {Object} [options] - 映射相关值的选项对象。\n * @returns {string} 生成的错误描述。\n */\nexport const getErrDesc = (key, options) => {\n  if (!errors[key]) {\n    return `Error code: \"${key}\", please go to https://github.com/ofajs/ofa-errors to view the corresponding error information`;\n  }\n\n  let desc = errors[key];\n\n  // 映射相关值\n  if (options) {\n    for (let k in options) {\n      desc = desc.replace(new RegExp(`{${k}}`, \"g\"), options[k]);\n    }\n  }\n\n  return desc;\n};\n","const getOid = () => Math.random().toString(32).slice(2);\n\nexport default class Onion {\n  constructor() {\n    this._middlewares = new Map();\n  }\n\n  use(middleware) {\n    const oid = getOid();\n    this._middlewares.set(oid, middleware);\n    return oid;\n  }\n\n  unuse(oid) {\n    return this._middlewares.delete(oid);\n  }\n\n  async run(context) {\n    let index = -1;\n\n    const middlewares = Array.from(this._middlewares.values());\n\n    const next = async () => {\n      index++;\n      if (index < middlewares.length) {\n        await middlewares[index](context, next);\n      }\n    };\n\n    await next();\n  }\n}\n","import { getErr } from \"../ofa-error/main.js\";\nimport Onion from \"./onion.mjs\";\n\nexport const caches = new Map();\nexport const wrapFetch = async (url, params) => {\n  const d = new URL(url);\n\n  const reUrl = params.includes(\"-direct\") ? url : `${d.origin}${d.pathname}`;\n\n  let fetchObj = caches.get(reUrl);\n\n  if (!fetchObj) {\n    fetchObj = fetch(reUrl);\n    caches.set(reUrl, fetchObj);\n  }\n\n  const resp = await fetchObj;\n\n  return resp.clone();\n};\n\nexport const processor = {};\n\nconst addHandler = (name, handler) => {\n  const oni = processor[name] || (processor[name] = new Onion());\n  oni.use(handler);\n};\n\nexport const use = (name, handler) => {\n  if (name instanceof Function) {\n    handler = name;\n    name = [\"js\", \"mjs\"];\n  }\n\n  if (name instanceof Array) {\n    name.forEach((name) => {\n      addHandler(name, handler);\n    });\n    return;\n  }\n\n  addHandler(name, handler);\n};\n\nuse([\"mjs\", \"js\"], async (ctx, next) => {\n  if (!ctx.result) {\n    const { url, params } = ctx;\n    const d = new URL(url);\n\n    const notHttp = /^blob:/.test(url) || /^data:/.test(url);\n    try {\n      if (notHttp || params.includes(\"-direct\")) {\n        ctx.result = await import(url);\n      } else {\n        ctx.result = await import(`${d.origin}${d.pathname}`);\n      }\n    } catch (error) {\n      const err = getErr(\n        \"load_module\",\n        {\n          url: ctx.realUrl || url,\n        },\n        error\n      );\n\n      if (notHttp) {\n        console.log(\"load failed:\", ctx.realUrl || url, \" ctx:\", ctx);\n      }\n\n      throw err;\n    }\n  }\n\n  await next();\n});\n\nuse([\"txt\", \"html\", \"htm\"], async (ctx, next) => {\n  if (!ctx.result) {\n    const { url, params } = ctx;\n\n    let resp;\n    try {\n      resp = await wrapFetch(url, params);\n    } catch (error) {\n      throw getErr(\"load_fail\", { url }, error);\n    }\n\n    if (!/^2.{2}$/.test(resp.status)) {\n      throw getErr(\"load_fail_status\", {\n        url,\n        status: resp.status,\n      });\n    }\n\n    ctx.result = await resp.text();\n  }\n\n  await next();\n});\n\nuse(\"json\", async (ctx, next) => {\n  if (!ctx.result) {\n    const { url, params } = ctx;\n\n    ctx.result = await wrapFetch(url, params).then((e) => e.json());\n  }\n\n  await next();\n});\n\nuse(\"wasm\", async (ctx, next) => {\n  if (!ctx.result) {\n    const { url, params } = ctx;\n\n    const data = await wrapFetch(url, params).then((e) => e.arrayBuffer());\n\n    const module = await WebAssembly.compile(data);\n    const instance = new WebAssembly.Instance(module);\n\n    ctx.result = instance.exports;\n  }\n\n  await next();\n});\n\nuse(\"css\", async (ctx, next) => {\n  if (!ctx.result) {\n    const { url, element, params } = ctx;\n\n    if (element) {\n      const link = document.createElement(\"link\");\n      link.rel = \"stylesheet\";\n      link.href = url;\n\n      const root = element.getRootNode();\n\n      if (root === document) {\n        root.head.append(link);\n      } else {\n        root.appendChild(link);\n      }\n\n      let f;\n      element.addEventListener(\n        \"disconnected\",\n        (f = (e) => {\n          link.remove();\n          element.removeEventListener(\"disconnected\", f);\n        })\n      );\n    } else {\n      ctx.result = await wrapFetch(url, params).then((e) => e.text());\n    }\n  }\n\n  await next();\n});\n","import { getErr } from \"../ofa-error/main.js\";\n\nexport const aliasMap = {};\n\nexport default async function config(opts) {\n  const { alias } = opts;\n\n  if (alias) {\n    Object.entries(alias).forEach(([name, path]) => {\n      if (!/^@.+/.test(name)) {\n        throw getErr(\"config_alias_name_error\", {\n          name,\n        });\n      }\n\n      if (!aliasMap[name]) {\n        if (!/^\\./.test(path)) {\n          aliasMap[name] = path;\n        } else {\n          throw getErr(\"alias_relate_name\", {\n            name,\n            path,\n          });\n        }\n      } else {\n        throw getErr(\"alias_already\", {\n          name,\n        });\n      }\n    });\n  }\n  return true;\n}\n\nexport const path = (moduleName, baseURI) => {\n  if (moduleName.startsWith(\"http://\") || moduleName.startsWith(\"https://\")) {\n    return moduleName;\n  }\n\n  const [url, ...params] = moduleName.split(\" \");\n\n  let lastUrl = url;\n\n  if (/^@/.test(url)) {\n    const [first, ...args] = url.split(\"/\");\n\n    if (aliasMap[first]) {\n      lastUrl = [aliasMap[first].replace(/\\/$/, \"\"), ...args].join(\"/\");\n    } else {\n      throw getErr(\"no_alias\", {\n        name: first,\n        url: moduleName,\n      });\n    }\n  }\n\n  if (typeof location !== \"undefined\") {\n    const base = baseURI ? new URL(baseURI, location.href) : location.href;\n\n    const moduleURL = new URL(lastUrl, base);\n\n    lastUrl = moduleURL.href;\n  }\n\n  if (params.length) {\n    return `${lastUrl} ${params.join(\" \")}`;\n  }\n\n  return lastUrl;\n};\n","import { processor, use } from \"./use.mjs\";\nimport { aliasMap, path } from \"./config.mjs\";\nexport const LOADED = Symbol(\"loaded\");\n\nconst createLoad = (meta, opts) => {\n  if (!meta) {\n    meta = {\n      url: document.location.href,\n    };\n  }\n  const load = (ourl) => {\n    let [url, ...params] = ourl.split(\" \");\n\n    const reurl = path(url, meta.url);\n\n    return agent(reurl, { params, ...opts });\n  };\n  return load;\n};\n\nexport const agent = async (url, opts) => {\n  const urldata = new URL(url);\n  const { pathname } = urldata;\n\n  let type;\n  let realUrl = null;\n\n  opts.params &&\n    opts.params.forEach((e) => {\n      if (/^\\..+/.test(e)) {\n        type = e.replace(/^\\.(.+)/, \"$1\");\n      } else if (/^\\-\\-real/.test(e)) {\n        realUrl = e.replace(/^\\-\\-real\\:/, \"\");\n      }\n    });\n\n  if (!type) {\n    type = pathname.slice(((pathname.lastIndexOf(\".\") - 1) >>> 0) + 2);\n  }\n\n  const ctx = {\n    url,\n    result: null,\n    realUrl,\n    ...opts,\n  };\n\n  const oni = processor[type];\n\n  if (oni) {\n    await oni.run(ctx);\n  } else {\n    const result = await fetch(url);\n    const contentType = result.headers.get(\"Content-Type\");\n\n    const targetMapObject = [\n      [\"application/javascript\", \"js\"],\n      [\"application/json\", \"json\"],\n      [\"text/html\", \"html\"],\n      [\"text/xml\", \"xml\"],\n    ].find((e) => contentType.includes(e[0]));\n\n    let newOni;\n    if (targetMapObject) {\n      newOni = processor[targetMapObject[1]];\n    }\n\n    if (newOni) {\n      await newOni.run(ctx);\n    } else {\n      ctx.result = result;\n    }\n  }\n\n  if (opts && opts.element) {\n    const { element } = opts;\n    element[LOADED] = true;\n    const event = new Event(\"load\");\n    element.dispatchEvent(event);\n  }\n\n  if (opts.params && opts.params.includes(\"-ctx\")) {\n    return ctx;\n  }\n\n  return ctx.result;\n};\n\nexport default function lm(meta, opts) {\n  return createLoad(meta, opts);\n}\n\nObject.defineProperties(lm, {\n  use: {\n    value: use,\n  },\n  alias: {\n    get() {\n      return { ...aliasMap };\n    },\n  },\n});\n","import { agent, LOADED } from \"./main.mjs\";\n\nclass LoadModule extends HTMLElement {\n  constructor(...args) {\n    super(...args);\n\n    this[LOADED] = false;\n\n    Object.defineProperties(this, {\n      loaded: {\n        get: () => this[LOADED],\n      },\n    });\n\n    this._init();\n  }\n\n  _init() {\n    if (this.__initSrc || this.attributes.hasOwnProperty(\"pause\")) {\n      return;\n    }\n\n    let src = this.getAttribute(\"src\");\n\n    if (!src) {\n      return;\n      // throw `The ${this.tagName.toLowerCase()} element requires the src attribut `;\n    }\n    this.__initSrc = src;\n\n    const load = lm(undefined, {\n      element: this,\n    });\n\n    load(src);\n\n    Object.defineProperties(this, {\n      src: {\n        configurable: true,\n        value: src,\n      },\n    });\n  }\n\n  connectedCallback() {\n    const event = new CustomEvent(\"connected\");\n    event.root = this._root = this.getRootNode();\n    this.dispatchEvent(event);\n  }\n\n  disconnectedCallback() {\n    const event = new CustomEvent(\"disconnected\");\n    event.root = this._root;\n    delete this._root;\n    this.dispatchEvent(event);\n  }\n\n  attributeChangedCallback(name, oldValue, newValue) {\n    if (name === \"src\") {\n      if (newValue && oldValue === null) {\n        this._init();\n      } else if (this.__initSrc && oldValue && newValue !== this.__initSrc) {\n        console.warn(\n          `${this.tagName.toLowerCase()} change src is invalid, only the first change will be loaded`\n        );\n        this.setAttribute(\"src\", this.__initSrc);\n      }\n    } else if (name === \"pause\" && newValue === null) {\n      this._init();\n    }\n  }\n\n  static get observedAttributes() {\n    return [\"src\", \"pause\"];\n  }\n}\n\nclass LM extends LoadModule {\n  constructor(...args) {\n    super(...args);\n  }\n}\n\nconst ready = () => {\n  customElements.define(\"load-module\", LoadModule);\n  customElements.define(\"l-m\", LM);\n  window.removeEventListener(\"load\", ready);\n};\n\nif (document.readyState === \"complete\") {\n  ready();\n} else {\n  window.addEventListener(\"load\", ready);\n}\n","import lm from \"./main.mjs\";\nimport \"./component.mjs\";\nimport config, { path } from \"./config.mjs\";\nlm.config = config;\nlm.path = path;\nObject.freeze(lm);\n\nwindow.lm = lm;\n\nexport default lm;\n"],"names":["error_origin","errors","globalThis","navigator","language","langFirst","toLowerCase","split","fetch","catch","then","e","json","err","console","error","data","Object","assign","getErr","key","options","desc","getErrDesc","errObj","Error","cause","k","replace","RegExp","Onion","constructor","this","_middlewares","Map","use","middleware","oid","Math","random","toString","slice","set","unuse","delete","async","context","index","middlewares","Array","from","values","next","length","caches","wrapFetch","url","params","d","URL","reUrl","includes","origin","pathname","fetchObj","get","clone","processor","addHandler","name","handler","Function","forEach","ctx","result","notHttp","test","import","realUrl","log","resp","status","text","arrayBuffer","module","WebAssembly","compile","instance","Instance","exports","element","link","document","createElement","rel","href","root","getRootNode","f","head","append","appendChild","addEventListener","remove","removeEventListener","aliasMap","path","moduleName","baseURI","startsWith","lastUrl","first","args","join","location","base","LOADED","Symbol","agent","opts","urldata","type","lastIndexOf","oni","run","contentType","headers","targetMapObject","find","newOni","event","Event","dispatchEvent","lm","meta","ourl","reurl","createLoad","defineProperties","value","alias","LoadModule","HTMLElement","super","loaded","_init","__initSrc","attributes","hasOwnProperty","src","getAttribute","undefined","load","configurable","connectedCallback","CustomEvent","_root","disconnectedCallback","attributeChangedCallback","oldValue","newValue","warn","tagName","setAttribute","observedAttributes","LM","ready","customElements","define","window","readyState","config","entries","freeze"],"mappings":"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"}