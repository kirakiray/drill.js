{"version":3,"file":"drill.min.js","sources":["../src/errors.mjs","../src/onion.mjs","../src/use.mjs","../src/config.mjs","../src/main.mjs","../src/component.mjs","../src/base.mjs"],"sourcesContent":["// const error_origin = \"http://127.0.0.1:5793/errors\";\nconst error_origin = \"https://ofajs.github.io/ofa-errors/errors\";\n\n// 存放错误信息的数据对象\nconst errors = {};\n\nif (globalThis.navigator && navigator.language) {\n  fetch(`${error_origin}/${navigator.language.toLowerCase()}.json`)\n    .catch(() => {\n      return fetch(`default.json`);\n    })\n    .then((e) => e.json())\n    .then((data) => {\n      Object.assign(errors, data);\n    });\n}\n/**\n * 根据键、选项和错误对象生成错误对象。\n *\n * @param {string} key - 错误描述的键。\n * @param {Object} [options] - 映射相关值的选项对象。\n * @param {Error} [error] - 原始错误对象。\n * @returns {Error} 生成的错误对象。\n */\nexport const getErr = (key, options, error) => {\n  const desc = getErrDesc(key, options);\n\n  let errObj;\n  if (error) {\n    errObj = new Error(desc, { cause: error });\n  } else {\n    errObj = new Error(desc);\n  }\n  return errObj;\n};\n\n/**\n * 根据键、选项生成错误描述\n *\n * @param {string} key - 错误描述的键。\n * @param {Object} [options] - 映射相关值的选项对象。\n * @returns {string} 生成的错误描述。\n */\nexport const getErrDesc = (key, options) => {\n  if (!errors[key]) {\n    return `Error code: \"${key}\", please go to https://github.com/ofajs/ofa-errors to view the corresponding error information`;\n  }\n\n  let desc = errors[key];\n\n  // 映射相关值\n  if (options) {\n    for (let k in options) {\n      desc = desc.replace(new RegExp(`{${k}}`, \"g\"), options[k]);\n    }\n  }\n\n  return desc;\n};\n","const getOid = () => Math.random().toString(32).slice(2);\n\nexport default class Onion {\n  constructor() {\n    this._middlewares = new Map();\n  }\n\n  use(middleware) {\n    const oid = getOid();\n    this._middlewares.set(oid, middleware);\n    return oid;\n  }\n\n  unuse(oid) {\n    return this._middlewares.delete(oid);\n  }\n\n  async run(context) {\n    let index = -1;\n\n    const middlewares = Array.from(this._middlewares.values());\n\n    const next = async () => {\n      index++;\n      if (index < middlewares.length) {\n        await middlewares[index](context, next);\n      }\n    };\n\n    await next();\n  }\n}\n","import { getErr } from \"./errors.mjs\";\nimport Onion from \"./onion.mjs\";\n\nexport const caches = new Map();\nexport const wrapFetch = async (url, params) => {\n  const d = new URL(url);\n\n  const reUrl = params.includes(\"-direct\") ? url : `${d.origin}${d.pathname}`;\n\n  let fetchObj = caches.get(reUrl);\n\n  if (!fetchObj) {\n    fetchObj = fetch(reUrl);\n    caches.set(reUrl, fetchObj);\n  }\n\n  const resp = await fetchObj;\n\n  return resp.clone();\n};\n\nexport const processor = {};\n\nconst addHandler = (name, handler) => {\n  const oni = processor[name] || (processor[name] = new Onion());\n  oni.use(handler);\n};\n\nexport const use = (name, handler) => {\n  if (name instanceof Function) {\n    handler = name;\n    name = [\"js\", \"mjs\"];\n  }\n\n  if (name instanceof Array) {\n    name.forEach((name) => {\n      addHandler(name, handler);\n    });\n    return;\n  }\n\n  addHandler(name, handler);\n};\n\nuse([\"mjs\", \"js\"], async (ctx, next) => {\n  if (!ctx.result) {\n    const { url, params } = ctx;\n    const d = new URL(url);\n\n    const notHttp = /^blob:/.test(url) || /^data:/.test(url);\n    try {\n      if (notHttp || params.includes(\"-direct\")) {\n        ctx.result = await import(url);\n      } else {\n        ctx.result = await import(`${d.origin}${d.pathname}`);\n      }\n    } catch (error) {\n      const err = getErr(\n        \"load_module\",\n        {\n          url: ctx.realUrl || url,\n        },\n        error\n      );\n\n      if (notHttp) {\n        console.log(\"load failed:\", ctx.realUrl || url, \" ctx:\", ctx);\n      }\n\n      throw err;\n    }\n  }\n\n  await next();\n});\n\nuse([\"txt\", \"html\", \"htm\"], async (ctx, next) => {\n  if (!ctx.result) {\n    const { url, params } = ctx;\n\n    let resp;\n    try {\n      resp = await wrapFetch(url, params);\n    } catch (error) {\n      throw getErr(\"load_fail\", { url }, error);\n    }\n\n    if (!/^2.{2}$/.test(resp.status)) {\n      throw getErr(\"load_fail_status\", {\n        url,\n        status: resp.status,\n      });\n    }\n\n    ctx.result = await resp.text();\n  }\n\n  await next();\n});\n\nuse(\"json\", async (ctx, next) => {\n  if (!ctx.result) {\n    const { url, params } = ctx;\n\n    ctx.result = await wrapFetch(url, params).then((e) => e.json());\n  }\n\n  await next();\n});\n\nuse(\"wasm\", async (ctx, next) => {\n  if (!ctx.result) {\n    const { url, params } = ctx;\n\n    const data = await wrapFetch(url, params).then((e) => e.arrayBuffer());\n\n    const module = await WebAssembly.compile(data);\n    const instance = new WebAssembly.Instance(module);\n\n    ctx.result = instance.exports;\n  }\n\n  await next();\n});\n\nuse(\"css\", async (ctx, next) => {\n  if (!ctx.result) {\n    const { url, element, params } = ctx;\n\n    if (element) {\n      const link = document.createElement(\"link\");\n      link.rel = \"stylesheet\";\n      link.href = url;\n\n      const root = element.getRootNode();\n\n      if (root === document) {\n        root.head.append(link);\n      } else {\n        root.appendChild(link);\n      }\n\n      let f;\n      element.addEventListener(\n        \"disconnected\",\n        (f = (e) => {\n          link.remove();\n          element.removeEventListener(\"disconnected\", f);\n        })\n      );\n    } else {\n      ctx.result = await wrapFetch(url, params).then((e) => e.text());\n    }\n  }\n\n  await next();\n});\n","import { getErr } from \"./errors.mjs\";\n\nexport const aliasMap = {};\n\nexport default async function config(opts) {\n  const { alias } = opts;\n\n  if (alias) {\n    Object.entries(alias).forEach(([name, path]) => {\n      if (!/^@.+/.test(name)) {\n        throw getErr(\"config_alias_name_error\", {\n          name,\n        });\n      }\n\n      if (!aliasMap[name]) {\n        if (!/^\\./.test(path)) {\n          aliasMap[name] = path;\n        } else {\n          throw getErr(\"alias_relate_name\", {\n            name,\n            path,\n          });\n        }\n      } else {\n        throw getErr(\"alias_already\", {\n          name,\n        });\n      }\n    });\n  }\n  return true;\n}\n\nexport const path = (moduleName, baseURI) => {\n  if (moduleName.startsWith(\"http://\") || moduleName.startsWith(\"https://\")) {\n    return moduleName;\n  }\n\n  const [url, ...params] = moduleName.split(\" \");\n\n  let lastUrl = url;\n\n  if (/^@/.test(url)) {\n    const [first, ...args] = url.split(\"/\");\n\n    if (aliasMap[first]) {\n      lastUrl = [aliasMap[first].replace(/\\/$/, \"\"), ...args].join(\"/\");\n    } else {\n      throw getErr(\"no_alias\", {\n        name: first,\n        url: moduleName,\n      });\n    }\n  }\n\n  if (typeof location !== \"undefined\") {\n    const base = baseURI ? new URL(baseURI, location.href) : location.href;\n\n    const moduleURL = new URL(lastUrl, base);\n\n    lastUrl = moduleURL.href;\n  }\n\n  if (params.length) {\n    return `${lastUrl} ${params.join(\" \")}`;\n  }\n\n  return lastUrl;\n};\n","import { processor, use } from \"./use.mjs\";\nimport { aliasMap, path } from \"./config.mjs\";\nexport const LOADED = Symbol(\"loaded\");\n\nconst createLoad = (meta, opts) => {\n  if (!meta) {\n    meta = {\n      url: document.location.href,\n    };\n  }\n  const load = (ourl) => {\n    let [url, ...params] = ourl.split(\" \");\n\n    const reurl = path(url, meta.url);\n\n    return agent(reurl, { params, ...opts });\n  };\n  return load;\n};\n\nexport const agent = async (url, opts) => {\n  const urldata = new URL(url);\n  const { pathname } = urldata;\n\n  let type;\n  let realUrl = null;\n\n  opts.params &&\n    opts.params.forEach((e) => {\n      if (/^\\..+/.test(e)) {\n        type = e.replace(/^\\.(.+)/, \"$1\");\n      } else if (/^\\-\\-real/.test(e)) {\n        realUrl = e.replace(/^\\-\\-real\\:/, \"\");\n      }\n    });\n\n  if (!type) {\n    type = pathname.slice(((pathname.lastIndexOf(\".\") - 1) >>> 0) + 2);\n  }\n\n  const ctx = {\n    url,\n    result: null,\n    realUrl,\n    ...opts,\n  };\n\n  const oni = processor[type];\n\n  if (oni) {\n    await oni.run(ctx);\n  } else {\n    const result = await fetch(url);\n    const contentType = result.headers.get(\"Content-Type\");\n\n    const targetMapObject = [\n      [\"application/javascript\", \"js\"],\n      [\"application/json\", \"json\"],\n      [\"text/html\", \"html\"],\n      [\"text/xml\", \"xml\"],\n    ].find((e) => contentType.includes(e[0]));\n\n    let newOni;\n    if (targetMapObject) {\n      newOni = processor[targetMapObject[1]];\n    }\n\n    if (newOni) {\n      await newOni.run(ctx);\n    } else {\n      ctx.result = result;\n    }\n  }\n\n  if (opts && opts.element) {\n    const { element } = opts;\n    element[LOADED] = true;\n    const event = new Event(\"load\");\n    element.dispatchEvent(event);\n  }\n\n  if (opts.params && opts.params.includes(\"-ctx\")) {\n    return ctx;\n  }\n\n  return ctx.result;\n};\n\nexport default function lm(meta, opts) {\n  return createLoad(meta, opts);\n}\n\nObject.defineProperties(lm, {\n  use: {\n    value: use,\n  },\n  alias: {\n    get() {\n      return { ...aliasMap };\n    },\n  },\n});\n","import { agent, LOADED } from \"./main.mjs\";\n\nclass LoadModule extends HTMLElement {\n  constructor(...args) {\n    super(...args);\n\n    this[LOADED] = false;\n\n    Object.defineProperties(this, {\n      loaded: {\n        get: () => this[LOADED],\n      },\n    });\n\n    this._init();\n  }\n\n  _init() {\n    if (this.__initSrc || this.attributes.hasOwnProperty(\"pause\")) {\n      return;\n    }\n\n    let src = this.getAttribute(\"src\");\n\n    if (!src) {\n      return;\n      // throw `The ${this.tagName.toLowerCase()} element requires the src attribut `;\n    }\n    this.__initSrc = src;\n\n    const load = lm(undefined, {\n      element: this,\n    });\n\n    load(src);\n\n    Object.defineProperties(this, {\n      src: {\n        configurable: true,\n        value: src,\n      },\n    });\n  }\n\n  connectedCallback() {\n    const event = new CustomEvent(\"connected\");\n    event.root = this._root = this.getRootNode();\n    this.dispatchEvent(event);\n  }\n\n  disconnectedCallback() {\n    const event = new CustomEvent(\"disconnected\");\n    event.root = this._root;\n    delete this._root;\n    this.dispatchEvent(event);\n  }\n\n  attributeChangedCallback(name, oldValue, newValue) {\n    if (name === \"src\") {\n      if (newValue && oldValue === null) {\n        this._init();\n      } else if (this.__initSrc && oldValue && newValue !== this.__initSrc) {\n        console.warn(\n          `${this.tagName.toLowerCase()} change src is invalid, only the first change will be loaded`\n        );\n        this.setAttribute(\"src\", this.__initSrc);\n      }\n    } else if (name === \"pause\" && newValue === null) {\n      this._init();\n    }\n  }\n\n  static get observedAttributes() {\n    return [\"src\", \"pause\"];\n  }\n}\n\nclass LM extends LoadModule {\n  constructor(...args) {\n    super(...args);\n  }\n}\n\nconst ready = () => {\n  customElements.define(\"load-module\", LoadModule);\n  customElements.define(\"l-m\", LM);\n  window.removeEventListener(\"load\", ready);\n};\n\nif (document.readyState === \"complete\") {\n  ready();\n} else {\n  window.addEventListener(\"load\", ready);\n}\n","import lm from \"./main.mjs\";\nimport \"./component.mjs\";\nimport config, { path } from \"./config.mjs\";\nlm.config = config;\nlm.path = path;\nObject.freeze(lm);\n\nwindow.lm = lm;\n\nexport default lm;\n"],"names":["errors","globalThis","navigator","language","fetch","toLowerCase","catch","then","e","json","data","Object","assign","getErr","key","options","error","desc","getErrDesc","errObj","Error","cause","k","replace","RegExp","Onion","constructor","this","_middlewares","Map","use","middleware","oid","Math","random","toString","slice","set","unuse","delete","async","context","index","middlewares","Array","from","values","next","length","caches","wrapFetch","url","params","d","URL","reUrl","includes","origin","pathname","fetchObj","get","clone","processor","addHandler","name","handler","Function","forEach","ctx","result","notHttp","test","import","err","realUrl","console","log","resp","status","text","arrayBuffer","module","WebAssembly","compile","instance","Instance","exports","element","link","document","createElement","rel","href","root","getRootNode","f","head","append","appendChild","addEventListener","remove","removeEventListener","aliasMap","path","moduleName","baseURI","startsWith","split","lastUrl","first","args","join","location","base","LOADED","Symbol","agent","opts","urldata","type","lastIndexOf","oni","run","contentType","headers","targetMapObject","find","newOni","event","Event","dispatchEvent","lm","meta","ourl","reurl","createLoad","defineProperties","value","alias","LoadModule","HTMLElement","super","loaded","_init","__initSrc","attributes","hasOwnProperty","src","getAttribute","undefined","load","configurable","connectedCallback","CustomEvent","_root","disconnectedCallback","attributeChangedCallback","oldValue","newValue","warn","tagName","setAttribute","observedAttributes","LM","ready","customElements","define","window","readyState","config","entries","freeze"],"mappings":"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"}