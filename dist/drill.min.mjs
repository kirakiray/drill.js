//! drill.js - v5.0.5 https://github.com/kirakiray/drill.js  (c) 2018-2023 YAO
const processor={},use=(e,t)=>{if(e instanceof Function&&(t=e,e=["js","mjs"]),e instanceof Array)return void e.forEach((e=>{(processor[e]||(processor[e]=[])).push(t)}));(processor[e]||(processor[e]=[])).push(t)};use(["mjs","js"],(({url:e})=>{const t=new URL(e);return import(`${t.origin}${t.pathname}`)})),use(["txt","html"],(({url:e})=>fetch(e).then((e=>e.text())))),use("json",(async({url:e})=>fetch(e).then((e=>e.json())))),use("wasm",(async({url:e})=>{const t=await fetch(e).then((e=>e.arrayBuffer())),s=await WebAssembly.compile(t);return new WebAssembly.Instance(s).exports}));const LOADED=Symbol("loaded"),createLoad=e=>{e||(e={url:document.location.href});return t=>{let s="";const[n,...r]=t.split(" ");if(e.resolve)s=e.resolve(n);else{const t=new URL(e.url);s=new URL(n,t).href}return agent(s,{params:r})}},agent=async(e,t)=>{const s=new URL(e),{pathname:n}=s,r=n.slice(2+(n.lastIndexOf(".")-1>>>0));let i;const o=processor[r];if(o)for(let s of o){const n=await s({url:e,data:i,...t});void 0!==n&&(i=n)}else i=fetch(e);if(t&&t.element){const{element:e}=t;e[LOADED]=!0;const s=new Event("load");e.dispatchEvent(s)}return i};function lm(e){return createLoad(e)}Object.assign(lm,{use:use});class LoadModule extends HTMLElement{constructor(...e){super(...e),this[LOADED]=!1,Object.defineProperties(this,{loaded:{get:()=>this[LOADED]}}),this._init()}_init(){if(this.__initSrc||this.attributes.hasOwnProperty("pause"))return;let e=this.getAttribute("src");e&&(this.__initSrc=e,e=new URL(e,location.href).href,Object.defineProperties(this,{src:{configurable:!0,value:e}}),agent(e,{element:this}))}attributeChangedCallback(e,t,s){"src"===e?s&&null===t?this._init():this.__initSrc&&t&&s!==this.__initSrc&&(console.warn(`${this.tagName.toLowerCase()} change src is invalid, only the first change will be loaded`),this.setAttribute("src",this.__initSrc)):"pause"===e&&null===s&&this._init()}static get observedAttributes(){return["src","pause"]}}class LM extends LoadModule{constructor(...e){super(...e)}}customElements.define("load-module",LoadModule),customElements.define("l-m",LM),"undefined"!=typeof window&&(window.lm=lm);export{lm as default};