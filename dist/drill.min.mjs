//! drill.js - v5.1.0 https://github.com/kirakiray/drill.js  (c) 2018-2023 YAO
class t{constructor(){this._middlewares=new Map}use(t){const e=Math.random().toString(32).slice(2);return this._middlewares.set(e,t),e}unuse(t){return this._middlewares.delete(t)}async run(t){let e=-1;const s=Array.from(this._middlewares.values()),n=async()=>{e++,e<s.length&&await s[e](t,n)};await n()}}const e={},s=(s,n)=>{(e[s]||(e[s]=new t)).use(n)},n=(t,e)=>{t instanceof Function&&(e=t,t=["js","mjs"]),t instanceof Array?t.forEach((t=>{s(t,e)})):s(t,e)};n(["mjs","js"],(async(t,e)=>{const{url:s,params:n}=t,r=new URL(s);n.includes("-direct")&&(t.result=await import(s)),t.result=await import(`${r.origin}${r.pathname}`),e()})),n(["txt","html"],(async(t,e)=>{const{url:s}=t;t.result=await fetch(s).then((t=>t.text())),e()})),n("json",(async(t,e)=>{const{url:s}=t;t.result=await fetch(s).then((t=>t.json())),e()})),n("wasm",(async(t,e)=>{const{url:s}=t,n=await fetch(s).then((t=>t.arrayBuffer())),r=await WebAssembly.compile(n),i=new WebAssembly.Instance(r);t.result=i.exports,e()}));const r=Symbol("loaded"),i=async(t,s)=>{const n=new URL(t),{pathname:i}=n,a=i.slice(2+(i.lastIndexOf(".")-1>>>0)),l={url:t,result:null,...s},c=e[a];if(c?await c.run(l):l.result=fetch(t),s&&s.element){const{element:t}=s;t[r]=!0;const e=new Event("load");t.dispatchEvent(e)}return l.result};function a(t){return(t=>(t||(t={url:document.location.href}),e=>{let s="";const[n,...r]=e.split(" ");if(t.resolve)s=t.resolve(n);else{const e=new URL(t.url);s=new URL(n,e).href}return i(s,{params:r})}))(t)}Object.assign(a,{use:n});class l extends HTMLElement{constructor(...t){super(...t),this[r]=!1,Object.defineProperties(this,{loaded:{get:()=>this[r]}}),this._init()}_init(){if(this.__initSrc||this.attributes.hasOwnProperty("pause"))return;let t=this.getAttribute("src");if(!t)return;this.__initSrc=t,t=new URL(t,location.href).href,Object.defineProperties(this,{src:{configurable:!0,value:t}});const[e,...s]=t.split(" ");i(e,{element:this,params:s})}attributeChangedCallback(t,e,s){"src"===t?s&&null===e?this._init():this.__initSrc&&e&&s!==this.__initSrc&&(console.warn(`${this.tagName.toLowerCase()} change src is invalid, only the first change will be loaded`),this.setAttribute("src",this.__initSrc)):"pause"===t&&null===s&&this._init()}static get observedAttributes(){return["src","pause"]}}class c extends l{constructor(...t){super(...t)}}const o=()=>{customElements.define("load-module",l),customElements.define("l-m",c),window.removeEventListener("load",o)};"complete"===document.readyState?o():window.addEventListener("load",o),window.lm=a;export{a as default};
//# sourceMappingURL=drill.min.mjs.map
